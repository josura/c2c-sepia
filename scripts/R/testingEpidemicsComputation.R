matriceTest <- t(matrix(c(
0, 0.932382, 0, 0, 0, 0, 0.716371, 0, 0, 0, 0, 0, 0.36628, 0.539137, 0, 0, 0.279416, 0, 0, 0, 0, 0, 0, 0.300993, 0, 0, 0, 0, 0, 0.407391, 0, 
0.932382, 0, 0.530758, 0.465651, 0.304865, 0, 0, 0.102038, 0.514735, 0.555138, 0, 0.979358, 0, 0, 0, 0, 0.805317, 0, 0, 0, 0, 0, 0, 0.261545, 0, 0.354588, 0, 0.661204, 0.0965385, 0, 0.0499474, 
0, 0.530758, 0, 0.736865, 0, 0.830574, 0.788553, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.969137, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.314179, 0, 0, 
0, 0.465651, 0.736865, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.304865, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0683335, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0.830574, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.621881, 0, 0, 0, 0, 0, 0, 0, 0, 0.231182, 0, 0, 
0.716371, 0, 0.788553, 0, 0, 0, 0, 0, 0, 0, 0.504463, 0, 0, 0, 0.781021, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.506827, 0.076707, 0, 0, 0, 
0, 0.102038, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.652038, 0.0506234, 0, 0, 0, 0, 0.308551, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.514735, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00241365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.242773, 0, 0, 0, 
0, 0.555138, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.324316, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0.504463, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.495769, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.979358, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.368711, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0.36628, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0586033, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0.539137, 0, 0, 0, 0, 0, 0, 0.652038, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0.781021, 0.0506234, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.368711, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0.279416, 0.805317, 0.969137, 0, 0, 0, 0, 0, 0.00241365, 0.324316, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0586033, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0.621881, 0, 0.308551, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0.0683335, 0, 0, 0, 0, 0, 0.495769, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0.300993, 0.261545, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.354588, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0.506827, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.661204, 0, 0, 0, 0, 0.076707, 0, 0.242773, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.0965385, 0.314179, 0, 0, 0.231182, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0.407391, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.0499474, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),nrow=31))

normalizedMatrix <- apply(t(matriceTest), 2, function(col) {
  if (sum(col) != 0) {
    col / sum(col)
  } else {
    rep(0, length(col))
  }
})


# Creating the identity matrix with the same dimensions as normalizedMatrix
identityMatrix <- diag(nrow(normalizedMatrix))

# Subtracting the transpose of the normalizedMatrix from the identity matrix
resultMatrix <- identityMatrix - normalizedMatrix

inverted <- ginv(resultMatrix)

input <- c(1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)


perturbation <- inverted %*% input
testingOutput <- c(0, 0.950788, -0.942415, -0.520173, -0.357386, -0.15881, 0.005347, 0.777801, 0.983573, -0.372066, -0.346979, 0.90666, -0.644835, -0.122374, 0.987533, 0.198856, -0.343247, -0.450986, 0, -0.163628, 0.47627, 0.515495, 0, 0, -0.061282, 0, -0.23782, 0.008046, -0.401329, -0.21321, 0.063392, -0.160045)


perturbationFromNeighbors <- normalizedMatrix %*% input
